---
title: Heap Overflow 취약점 이해: 예시와 방지 방법
categories: [Hacking, Theory]
tags: [Hacking, System hacking]
date: 2023-08-20 23:08:00 +0900
---

Heap Overflow 취약점은 프로그램의 동적 할당된 메모리인 힙(heap) 영역을 초과하여 데이터를 쓸 때 발생하는 보안 취약점입니다. 이번 글에서는 Heap Overflow 취약점의 개념을 자세히 설명하고, 실제 예시를 통해 그 작동 원리와 방지 방법을 알아보겠습니다.

## Heap Overflow 취약점이란?

힙은 동적으로 할당되는 메모리 영역으로, 프로그램 실행 중에 필요한 메모리를 동적으로 할당하고 해제할 때 사용됩니다. Heap Overflow 취약점은 프로그램이 할당된 힙 영역을 초과하여 데이터를 저장하거나 수정하려고 할 때 발생합니다. 이는 힙 영역 주변에 있는 데이터를 침범하거나 덮어쓰는 문제를 초래하여 보안 문제로 이어질 수 있습니다.

## Heap Overflow 취약점 예시

가정해보겠습니다. 아래의 C 코드는 사용자의 입력을 받아 동적으로 메모리를 할당하고 값을 저장하는 프로그램입니다.

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int size;
    printf("할당할 메모리 크기를 입력하세요: ");
    scanf("%d", &size);

    int *data = (int *)malloc(size * sizeof(int));

    printf("값을 입력하세요: ");
    for (int i = 0; i < size; i++) {
        scanf("%d", &data[i]);
    }

    // 메모리 해제
    free(data);

    return 0;
}
```

이 코드에서 사용자는 할당할 메모리 크기와 값을 입력합니다. 그런데 사용자가 할당된 메모리 크기를 초과하는 값을 입력한다면 어떻게 될까요?

사용자 입력: 5 (할당된 메모리 크기는 3)

이 경우, 사용자가 입력한 값이 할당된 메모리 크기를 초과하여 힙 영역 주변의 메모리를 침범하게 됩니다. 이는 예상치 못한 동작, 메모리 누수, 시스템의 불안정 또는 악의적인 코드 실행을 초래할 수 있습니다.

## Heap Overflow 취약점 방지 방법

Heap Overflow 취약점을 방지하기 위해서는 다음과 같은 방법을 고려해야 합니다.

1. **메모리 크기 검증**: 할당할 메모리 크기를 사용자 입력으로부터 검증하여 올바른 범위 내에 있는지 확인합니다.

2. **버퍼 오버플로우 방지**: 데이터 입력 시, 배열 범위를 확인하여 할당된 메모리를 초과하지 않도록 합니다.

3. **보안 강화**: 메모리 관리 기법을 사용하여 힙 영역을 관리하고, 힙 오버플로우를 탐지하고 예방하는 방법을 사용합니다.

## 결론

Heap Overflow 취약점은 힙 영역의 할당된 메모리를 초과하여 데이터를 저장하거나 수정할 때 발생하는 중요한 보안 문제입니다. 프로그램에서 사용자 입력과 할당된 메모리를 신중하게 다루고, 메모리 크기 검증 및 버퍼 오버플로우 방지 등의 접근 방식을 사용하여 Heap Overflow 취약점을 예방할 수 있습니다. 이를 통해 프로그램의 안전성을 확보하고 보안 취약점을 방지하는데 기여할 수 있습니다.